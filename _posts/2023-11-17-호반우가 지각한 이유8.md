---
title: "[BOJ] 호반우가 지각한 이유 8"
author:
name: 이민석
date: 2023-11-17 20:28:00 +0900
categories: ["PS"]
tags: ["볼록 껍질","우선 순위 큐"]
math: true
---


[BOJ 호반우가 지각한 이유 8](https://www.acmicpc.net/problem/30475)

## 풀이

먼저 문제에서 말하는 $0$번부터 $e$번까지의 행성들을 모두 포함하는 가장 작은 볼록 다각형을 $H_e$ 라 하자. 해당 볼록 다각형은 반드시 $e$번 행성을 포함하므로 $e$ 번 행성을 기준으로 해당 볼록 다각형을 위 아래 $upper, \space lower$로 나눌 수 있다.\
이 때, $upper,\space lower$에 포함된 모든 정점을 $x$에 대한 오름차순으로 나열하면 $upper$ 는 시계 방향, $lower$ 는 반시계 방향으로 배치 되게 된다.\
따라서 행성을 순차적으로 순회하며 $e$ 번 행성을 기준으로 $upper, lower$ 를 나누어 관리한다면 항상 $0$번부터 $e$번까지의 행성들을 모두 포함하는 가장 작은 볼록 다각형을 만들 수 있다.\
따라서 $H_e$ 에 대해서 $e-m \sim e-1$ 번 행성들 중, 현재 볼록 다각형의 포함된 행성 중에서 가장 빠르게 갈 수 있는 곳까지의 시간 $x$, 볼록 다각형에 포함되지 않는 행성 중, 가장 빠르게 갈 수 있는 곳까지의 시간 $y$ 에 대하여 $min(x+a_e, y+b_e)$ 를 구한다. 이는 우선 순위 큐를 이용하면 빠르게 해결할 수 있다.

먼저 $e$ 번 행성에 대하여 $0 \sim e-1 $ 번 행성으로 만든 $H_{e-1}$ 에서 $upper$ 와 $lower$ 에는 $e-1$ 번 행성이 포함되어 있다. \
만약 $H_e$ 에 $e-1$ 번 행성이 포함되어 있지 않다면 이는 $e$ 번 행성을 $upper$ 와 $lower$ 추가했을 때, 각각 반시계, 시계 방향으로 회전한다는 것을 의미한다. 만약 포함되어있다면 최소한 $upper$ 에 시계방향으로 배치되었거나 $lower$에 반시계 방향으로 배치되었다는 것이다. 따라서 각 정점이 $upper, \space lower$ 에서 모두 제거됐다면 볼록 다각형에 포함되지 않는다는 것이다.\
이렇게 볼록 다각형에 한 번이라도 포함되지 않는 행성은 이후에도 포함되지 않기 때문에 최초로 $upper, lower$ 에 포함되지 않는 순간부터 볼록 다각형에 없는 행성이라 해도 무방하다.\

따라서 모든 행성들은 각각 $upper, lower$ 에 한 번씩 포함되고 최대 한 번 씩 제거 되며 $upper, lower$ 에서 행성이 제거될 땐 뒤에서부터 순차적으로 제거 되고 최단 경로는 우선 순위 큐를 이용하여 관리하기에 $O(N+NlogN)$ 의 시간 복잡도를 가진다.