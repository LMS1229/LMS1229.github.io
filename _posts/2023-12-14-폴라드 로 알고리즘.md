---
title: 폴라드 로 알고리즘
layout: post
author:
name: 이민석
date: 2023-12-14 22:00:00 +0900
categories: ["수학","정수론"]
tag : ["그래프"]
math: true
---

## 요약
어떤 양의 정수 $N$ 에 대하여 약수를 구하는 문제에 대하여 해당 알고리즘을 사용할 수 있다.\
해당 알고리즘은 $O(N^{1/4})$ 의 시간 복잡도를 가지며 이 글을 읽기 전에 아래의 글을 먼저 보고 오는 것을 요한다.

["Floyd's toutise and hare"]({% post_url 2023-12-14-Floyd's toutise and hare %})

---
## 핵심
먼저 $N=pq\ (p \ne 1,\  p,q \in \mathbb{N})$ 라고 가정하자. 이 때, $f(x)$를 다항식을 $N$ 으로 나눈 나머지라 하자. (e.g. $f(x)=(x^2 + c) \bmod{N}$)\
$x_1=a (a\in \mathbb{N}) , x_{i+1}=f(x_i) (i \ge 1)$ 라 한다면 비둘기집 원리에 의해
$x_i=x_{i+k}\,\ (i\ge 1)$ 를 만족하는 $i$ 와 $k$가 존재한다.

따라서 수열 $\{x_k\space \bmod{p} \}$ 또한 사이클이 존재하며  $\{x_k\}$ 와의 관계가 해당 알고리즘의 핵심 키워드이다. 

어떠한 수 $x_1$ 에 대하여 $N$의 진약수 $d$ 에 대하여 다음과 같은 성질을 만족한다.

$$
\exists i,j:x_i \equiv x_j \pmod{d} (x_i \not\equiv x_j \pmod{N}) 
$$

---
### 증명
$\forall i,j:x_i \not\equiv x_j \pmod{d} (x_i \not\equiv x_j \pmod{N}) $ 라고 하자.\
비둘기집 원리로 인해 $\{x_k\}$ 에는 $N$개 이하의 수로 이루어진 사이클이 존재한다. \
해당 사이클에 존재하는 수를 $d$ 로 나눈 나머지에 대하여 $x_k \bmod d$ 가 같은 $x_k$ 가 2개 이상 존재할 수 있다. 따라서 위 가정은 모순이다. 

---

그러나 우리는 $d$ 를 찾아야 한다. 그렇다면 $d$ 를 어떻게 찾아야 할까?\
먼저 $x_1$ 에 대하여 $\exists i,j:x_i \equiv x_j \pmod{d} (x_i \not\equiv x_j \pmod{N})$ 가 존재한다고 가정하자. 그렇다면 $(x_i - x_j) \equiv 0 \pmod{d}$ 이므로 $gcd(x_i - x_j, N) = d$ 가 된다.\
이러한 $x_i, x_j$를 찾는 방법은 `Floyd's toutise and hare` 알고리즘을 이용하면 된다. 

---

## 탐색
$x_{i+1}=f(x_i)$ 를 보면 우리는 수열 $\{x_k\}$ 를 간선 $(x_i,x_{i+1})$ 로 이루어진 그래프로 표현할 수 있다. 해당 그래프는 사이클이 존재하는 단방향 연결리스트의 형태를 보인다.

따라서 우리는 모든 $x_i$ 에 대하여 $j=2i$ 와 $j=2i+1$ 에 대하여 $x_i$ 와 $x_j$에 대한 비교를 수행하면 된다.

이는  `Floyd's toutise and hare` 를 이용하면 모든 $x_i, x_j$ 를 찾을 수 있다.

```
x ← random number
y ← x
d ← 1
while d = 1:
    x ← f(x)
    y ← f(f(y))
    d ← gcd(|x - y|, N) 
if d = N:
    return fail
else:
    return d
```
이 때, $gcd(x_i - x_j, N) = N$ 이라면 $(x_i = x_j)$초기 값 $x_1$ 에 대하여 주어진 $d$ 를 찾는데 실패한 것으로 간주하여 $x_1$ 를 다른 값으로 하여 다시 시작하거나 다른 $f$ 를 이용하여 다시 $d$ 를 찾는다. 

---

## 시간 복잡도
생일 역설에 의해 합성수 $N$ 에 대하여 $\{x_k\}$ 에서 사이클이 발생하기 위한 수의 개수는 평균적으로 $\theta (\sqrt{N})$ 이다. 이 때 $N$의 약수 $p$ 에 대하여 $\{y_k = x_k \bmod p\}$ 라 한다면 $p$ 를 찾는 순간, $gcd(x_{2i}-x_{i} , N)$ 또한 $p$ 의 배수이고 $y_{2i}=y_{i}$ 로 $\{y_k\}$ 에서 사이클을 이루게 된다.

생일 역설에 의해  $\{y_k\}$에서 사이클이 발생하기 위해선 평균적으로  $\theta (\sqrt{p})$ 개의 수가 필요하므로 $p$ 를 찾기 위해선 확인할 수의 개수는 평균적으로 $\theta(\sqrt{p})$ 정도로 추측할 수 있다.

하지만 폴라드 로 알고리즘은 랜덤한 수에 대하여 $p$의 존재를 확인하는 것이기에 생각보다 느리게 작동할 수 있다. 


