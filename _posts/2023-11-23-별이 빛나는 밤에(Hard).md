---
title: "[BOJ] 별이 빛나는 밤(Hard)"
author:
name: 이민석
date: 2023-11-23 20:28:00 +0900
categories: ["PS"]
tags: ["그리디","포함 배제 원리"]
math: true
---


[BOJ 별이 빛나는 밤(Hard)](https://www.acmicpc.net/problem/30683)

## 풀이

먼저 별의 밝기가 적용되는 격자들을 다음과 같이 4등분 하자.\
> $(x,y)$ 에 대하여\
> $(x,y+1) \sim (x+p-2,y+p-1)$ \
> $(x+1,y) \sim (x+p-1,y-p+2)$ \
> $(x,y-1) \sim (x-p-2,y-p+1)$ \
> $(x-1,y) \sim (x-p-1,y+p-2)$

그렇다면 나눠진 영역에서의 별의 밝기는 직각 삼각형 형태로 기준점 $(a,b)$ 에 대하여 $(a+p-2, b+p-2)$ 까지 들어간 별의 밝기 중, 사진 영역에 포함되는 밝기의 합을 구하는 형태로 표현할 수 있다. 

이 때, $(a,b)$ 에 대하여 $(a+p-2, b+p-2)$ 까지 들어간 별의 밝기의 합은 가장 밝은 빛의 밝기 $x$ 에 대하여 다음과 같다.
$$f(x)=\sum_{i=1}^{x}i(x-i+1)=x(x+1)(x+2)/6$$

따라서 나눠진 영역 중, 사진의 영역 $(x_1, y_1)\sim (x_2,y_2)$에 들어간 가장 큰 밝기 $p$의  위치를 $(x_{pivot},y_{pivot}) $ 이라 한다면 다음과 같이 구할 수 있다. 
$$
f(p) - f(max(0,p-(x_2-x_{pivot}))) - f(max(0,p-(y_2-y_{pivot}))) + f(max(0,p-(x_2-x_{pivot})-y_2-y_{pivot}))
$$

최종적으로 모든 별에 대하여 나눠진 영역을 $(a,b)$ 에 대하여 $(a+p-2, b+p-2)$ 까지의 영역으로 변환한 뒤, 사진 영역에 있는 밝기의 합을 구하면 된다. 