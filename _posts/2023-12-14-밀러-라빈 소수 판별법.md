---
title: 밀러-라빈 소수 판별법
layout: post
author:
name: 이민석
date: 2023-12-14 22:00:00 +0900
categories: ["수학","정수론"]
tag : ["그래프"]
math: true
---

## 개요
페르마의 소정리에 따르면 소수 $p$ 에 대하여 모든 정수 $a$ 는 다음을 만족한다.

>$a^{p-1} \equiv 1 \pmod p$

이를 이용해, 어떤 수 $x$ 가 합성수임을 확정할 수 있는 방법을 알아보자.

---

## 배경
$p$가 홀수면 $p-1=d \cdot 2^k (d \not | \ 2)$ 로 나타낼 수 있다. 이 때 $p$ 가 소수라면 $x^2 \equiv 1 \pmod p \rightarrow x \equiv 1 \ or \ x \equiv -1 \pmod p$ 이므로 다음의 두 식 중 하나를 만족한다. 

$$
a^d \equiv 1 \pmod p \\
\exist r \in [0:k-1] : a^{2^rd} \equiv -1 \pmod p 
$$

따라서 두 식을 모두 만족하지 않는다면 $p$ 는 합성수이다. 

---

## 동작 방식

먼저 판별할 수 $n$ 과 검사할 $a$ 의 개수 $k$ 를 정한다.\
$n-1 = d \cdot 2^k (d \not | \ 2)$ 형태로 바꾸어 다음의 과정을 $k$ 번 반복한다.
1. $a\in [1:n-1]$ 인 $a$ 를 고른다.
2. $\forall r \in [0:s-1]:a^d \not\equiv 1 \pmod n$ 이고 $a^{2^rd} \not\equiv -1 \pmod n$ 이면 $n$ 은 합성수이고 아니라면 "아마" 소수일 것이다.


---

## 아마도?
위 동작 방식의 마지막을 보면 아마도 소수일 것이라 했다. 그 이유는 `p가 소수` 면 `조건을 만족` 하기에 `조건을 만족하지 않는다` 면 `p는 합성수` 임을 유도한 것이기 때문이다. \
즉, 입력한 수가 합성수여도 조건을 만족할 수 있다는 것이다. 

그러나 다행히 작은 수에선 몇가지 $a$에 대해서만 검사해도 소수임을 확정지을 수 있다는 것이 증명됐다.
