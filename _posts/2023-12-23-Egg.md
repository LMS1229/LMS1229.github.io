---
title: Egg
layout: post
author:
name: 이민석
date: 2023-12-23 23:00:00 +0900
categories: ["PS"]
tag : ["퍼시스턴트 세그먼트 트리", "스위핑"]
math: true
---

[BOJ Egg](https://www.acmicpc.net/problem/11012)

## 풀이
가장 기본적인 아이디어는 다차원 세그먼트 트리이다.

그러나 다차원 세그먼트 트리로 풀기에는 공간의 크기가 너무 크다. 다르게 생각해보자

먼저 $[l,r] \times [b,t] = [l,r] \times [-1,t] - [l,r] \times [-1,b-1]$ 로 볼 수 있다.

따라서 가로축에 대한 세그먼트 트리를 $y=k$ 까지 구간 별로 얼만큼에 계란이 있는지를 저장해두어 계산해둔다면 위와 같이 계산할 수 있을 것이다. 

이 때, $y$ 가 증가할때 마다 세그먼트 트리는 갱신되는 노드와 안되는 노드가 존재하므로 `퍼시스턴트 세그먼트 트리`를 이용하면 필요한 노드의 개수를 줄일 수 있다. 

그러므로 계란의 위치들에 대해서 $y$ 별로 모아두어, $y$ 별로 퍼시스턴트 세그먼트 트리를 만들어 두어 $y=k$ 까지 $x$ 의 구간 별로 존재하는 계란의 개수를 저장해둔다.\
그렇다면 해당 세그먼트 트리에는  $y=k$ 까지 구간 별로 얼만큼에 계란이 있는지가 저장되어있다.

그리고 쿼리가 들어올때 마다 $y=t$ 에서 만든 세그먼트 트리에서 구간 $[l,r]$ 의 값 $x$ , $y=b-1$ 에서 만든 세그먼트 트리에서 구간 $[l,r]$ 의 값 $y$ 를 구하면 $x-y$ 는 우리가 원하는 값이 된다.  