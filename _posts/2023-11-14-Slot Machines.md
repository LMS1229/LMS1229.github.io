---
title: "[BOJ] Slot Machines"
author:
name: 이민석
date: 2023-11-14 19:17:00 +0900
categories: ["PS"]
tags: ["KMP"]
math: true
toc: true
---

[BOJ Slot Machines](https://www.acmicpc.net/problem/14959)

# 풀이

영어 문제는 거의 보지 않아서 매우 힘들었다…

문제를 요약하면 슬롯 머신을 돌려 $n$ 개의 연속된 수가 등장한다. 이 수 들을 $T[1], T[2], T[3], ... , T[n]$ 이라 했을 때 $T[1:k]$ 까지는 무작위로 돌아가지만 $T[k+1], T[k+2], ...,T[k+p]$  가 반복하여 등장한다는 것이니, $k$ 와 $p$ 를 구하는데 여러 경우가 있다면 $k+p$ 가 작은 걸 구하라는 문제이다.

극단적인 예시로는 $k=0, p=n$ 일 수 있다.  

먼저 위 조건을 맞는 $k$ 와 $p$  에 대하여 만약  $k=0, p=n$ 가 아니라 가정한다면 앞의 $k$ 개의 숫자를 제외한다면 남은 숫자들 $T^\prime [i] = T[i+k]$ 에 대하여 $T^\prime$ 의 가장 짧은 주기 $p$ 를 찾으면 되는 것이다. 

이는 kmp 알고리즘을 이용해, 해결할 수 있다. 

그러나 모든 $k(\leq n)$ 에 대한 $T^\prime$ 에서 $p$ 를 구하는 것은 매우 오래 걸린다. 이는 $T$ 를 뒤집어 kmp 알고리즘을 한 번만 적용하여 모든 $k$ 에 대하여 $p$ 를 구할 수 있다. 

$T$ 를 뒤집은 수열 $T'$ 에 대한 실패 함수 $f$ 에 대하여 $f(i)=x (1\le i \le n)$ 라면 $T'[i-x +j]=T'[j]\space (1 \le j \le x)$ 이다.  

따라서 $[T'[1],T'[2],T'[3],...T'[x],...,T'[i-x]]=[T'[i-x+1],T'[i-x+2],...,T'[i],T'[x+1],...,T'[i-x]]$ 가 된다. 이는 주기 $p=i-x=i-f(i)$ 임을 나타낸다.

그리고 $T'[1:i]$ 는 $T$ 에서 $T[1:n-i]$ 를 제외하고 나머지 부분 뒤집은 것으로 $k=n-i$ 가 된다.

따라서 $T'[i]=T[n-i+1]$ 인 $T'$ 의 실패 함수 $f$ 에 대하여 $k=n-i, p=i-f(i)$ 이므로
문제의 조건에 맞는  $k$ 와 $p$ 를 구하면 된다.