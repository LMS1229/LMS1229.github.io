---
title: "[BOJ] 전선 연결하기"
author:
name: 이민석
date: 2025-04-19 08:10:00 +0900
categories: ["PS"]
tag: ["최소 스패닝 트리"]
toc: true
math: true
---

[BOJ 33686 전선 연결하기](https://www.acmicpc.net/problem/33686)

## 풀이

전선으로 연결할 수 있는 두 점은 트리에서 단순 경로의 길이가 2 이상이 된다.

그래서 일단 길이가 2이상인 경로를 간선으로 하는 그래프의 MST를 만들어야 하는 것을 알 수 있다.

그러나 이러면 간선의 개수는 $O(N^2)$ 이 되므로 필요하지 않는 간선을 쳐내야 한다.

이 때 필요하지 않은 단순 경로의 길이는 4이상이다.

### 증명
단순 경로에 있는 간선이 $(a_1, a_2), (a_2,a_3), (a_3,a_4), (a_4,a_5)$ 이고 해당 경로에 대한 전선이 구하고자 하는 MST에 포함되어 있다고 가정하자.

그렇다면 도로의 가중치는 양수이기 때문에 $a_2 \sim a_5$ , 혹은 $a_1 \sim a_4$ 까지 MST를 구성한 상태에서 해당 전선이 추가되었을 것이다.

그러나, 이보다 낮은 비용의 전선으로 트리 구성하는 것이 가능하기에 4이상의 경로는 필요가 없게 된다.

길이가 2,3인 경로의 간선은 반드시 필요하다.

>이는 길이가 3인 경로의 점들을 연결하기 위함이다.
{: .prompt-info}


### 경로 길이가 2인 경우

경로의 길이가 2인 경우, 어느 한 점을 거치게 되므로 그 점을 중심으로 보면 된다.

어느 한 점을 중심으로 필요한 전선들은 그 점에 연결된 (가장 비용이 싼 도로 + 나머지 도로) 에 대한 전선이 된다.

그 외의 전선을 이용하는 것은 위의 경우보다 손해이기 때문에 굳이 사용할 필요는 없다.


### 경로 길이가 3인 경우

길이가 3인 경우는 2인 경우를 구하는 것에서 중심을 점이 아닌 도로로 구하면 된다.

도로 $(u,v)$ 를 기준으로 $u$ 에 연결된 도로 중 가장 싼 비용의 도로와 $v$ 에 연결된 도로 중 가장 싼 비용의 도로로 연결된 경로를 전선으로 연결하면 된다.
